package {{.PackageName}}

import (
	"github.com/bozz33/sublimego/form"
	"github.com/bozz33/sublimego/table"
	"github.com/bozz33/sublimego/ui/layouts"
)

// {{.TemplName}}Content renders the page content.
// This is a templ component that can include forms, tables, and custom HTML.
templ {{.TemplName}}Content(pageForm *form.Form, pageTable *table.Table) {
	@layouts.Base("{{.Label}}") {
		<div class="p-6">
			<div class="mb-6">
				<h1 class="text-2xl font-bold text-gray-900 dark:text-white">{{.Label}}</h1>
				<p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
					{{.Description}}
				</p>
			</div>

			// Example: Display a form section
			<div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 mb-6">
				<h2 class="text-lg font-semibold mb-4">Form Example</h2>
				<form method="POST" action={ templ.SafeURL("/{{.Slug}}") }>
					for _, component := range pageForm.Schema {
						@renderFormField(component)
					}
					<div class="mt-4">
						<button type="submit" class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700">
							Submit
						</button>
					</div>
				</form>
			</div>

			// Example: Display a table section
			<div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6">
				<h2 class="text-lg font-semibold mb-4">Table Example</h2>
				<div class="overflow-x-auto">
					<table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
						<thead>
							<tr>
								for _, col := range pageTable.Columns {
									<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
										{ col.GetLabel() }
									</th>
								}
							</tr>
						</thead>
						<tbody class="divide-y divide-gray-200 dark:divide-gray-700">
							if len(pageTable.Rows) == 0 {
								<tr>
									<td colspan={ fmt.Sprintf("%d", len(pageTable.Columns)) } class="px-6 py-4 text-center text-gray-500">
										No data available
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	}
}

// renderFormField renders a single form field based on its type.
templ renderFormField(component form.Component) {
	<div class="mb-4">
		<label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
			{ component.GetLabel() }
			if component.IsRequired() {
				<span class="text-red-500">*</span>
			}
		</label>
		<input
			type="text"
			name={ component.GetName() }
			placeholder={ component.GetPlaceholder() }
			class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"
			if component.IsRequired() {
				required
			}
			if component.IsDisabled() {
				disabled
			}
		/>
		if component.GetHelp() != "" {
			<p class="mt-1 text-sm text-gray-500">{ component.GetHelp() }</p>
		}
	</div>
}
